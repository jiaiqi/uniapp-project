(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-public-proc-procDetail-procDetail"],{"2e5a":function(e,t,a){"use strict";a.r(t);var i=a("77e0"),r=a("a272");for(var n in r)"default"!==n&&function(e){a.d(t,e,(function(){return r[e]}))}(n);a("c68e");var o,s=a("f0c5"),l=Object(s["a"])(r["default"],i["b"],i["c"],!1,null,"31c9b99a",null,!1,i["a"],o);t["default"]=l.exports},"2f8e":function(e,t,a){"use strict";var i=a("5a6a"),r=a.n(i);r.a},"3c04":function(e,t,a){var i=a("24fb");t=i(!1),t.push([e.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 引入uview样式 */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */.proc-wrap[data-v-89584666]{padding-bottom:%?150?%;position:relative}.proc-wrap .nav[data-v-89584666]{height:%?90?%}.proc-wrap .scroll-fixed[data-v-89584666]{top:%?90?%;z-index:1024;position:fixed}.proc-wrap .uni-popup[data-v-89584666]{z-index:999}.proc-wrap[data-v-89584666] .uni-scroll-view{height:auto}.flow-view[data-v-89584666]{width:100%;margin-top:%?10?%;background-color:#fff;overflow:hidden}.flow-view .scroll-view[data-v-89584666]{padding:%?30?% %?10?%}.flow-view .cu-timeline .cu-item[data-v-89584666]{padding:5px 15px 5px 54px;position:relative;display:block;z-index:0}.flow-view .cu-timeline .head[data-v-89584666]{display:-webkit-box;display:-webkit-flex;display:flex}.flow-view .cu-timeline .name[data-v-89584666]{-webkit-box-flex:1;-webkit-flex:1;flex:1;font-size:%?34?%;line-height:%?60?%;font-weight:700}.flow-view .cu-timeline .state[data-v-89584666]{-webkit-box-flex:1;-webkit-flex:1;flex:1;font-size:%?30?%;line-height:%?60?%}.step-list[data-v-89584666]{width:100%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column}.step-list .step-list-item[data-v-89584666]{background-color:#fff;width:calc(100% - %?20?%);display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;margin:%?10?%;padding:%?20?%;-webkit-border-radius:%?10?%;border-radius:%?10?%}.step-list .step-list-item .title[data-v-89584666]{font-size:%?32?%;line-height:%?50?%;font-weight:700}.step-list .step-list-item .detail[data-v-89584666]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between}.step-list .step-list-item .detail .detail-item[data-v-89584666]{min-width:40%}.detail-view[data-v-89584666]{margin-top:%?10?%;padding-bottom:%?150?%;min-height:100vh;background-color:#fff;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column}.cu-dialog[data-v-89584666]{height:auto}.form-view[data-v-89584666]{background-color:#fff;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;align-items:center;max-height:calc(100vh - %?200?%);padding:%?30?% 0 %?100?%;overflow:scroll}.form-view .button-box[data-v-89584666]{height:%?100?%;width:100%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center;margin:%?20?% 0 %?40?%}.form-view .cu-btn[data-v-89584666]{max-width:60%;min-height:%?60?%;margin-top:%?50?%}.bottom-bar[data-v-89584666]{background-color:#fff;z-index:20;width:100%;height:%?100?%;padding-left:%?20?%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;border-top:1px solid hsla(0,0%,60%,.5);position:fixed;bottom:0}.bottom-bar .text-blue[data-v-89584666]{font-weight:700;font-size:%?32?%}.content-box[data-v-89584666]{margin-bottom:%?100?%}',""]),e.exports=t},"5a6a":function(e,t,a){var i=a("3c04");"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var r=a("4f06").default;r("3cd67573",i,!0,{sourceMap:!1,shadowMode:!1})},"77e0":function(e,t,a){"use strict";var i;a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){return i}));var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",{staticClass:"bg"},[a("v-uni-view",{staticClass:"steps"},e._l(e.infoList,(function(t,i){return a("v-uni-view",{key:i,staticClass:"steps_item"},[0!=i?a("v-uni-view",{class:{"bg-gradual-green":i<e.scroll||"已处理"===t.state,"bg-blue":i===e.scroll&&"已处理"!==t.state,"bg-white":i>e.scroll}}):e._e(),a("v-uni-text",{class:{"bg-gradual-green":i<e.scroll||"已处理"===t.state,"bg-blue":i===e.scroll&&"已处理"!==t.state,"bg-white":i>e.scroll,"text-grey":i>e.scroll}},[e._v(e._s(i+1))])],1)})),1),a("v-uni-view",{staticClass:"info_list"},e._l(e.infoList,(function(t,i){return a("v-uni-view",{key:i,staticClass:"info_item shadow-blur",class:{"bg-gradual-green":i<e.scroll||"已处理"===t.state,"bg-blue":i===e.scroll&&"已处理"!==t.state,"bg-white":i>e.scroll},style:{animation:"info "+(.2*i+1)+"s"},on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.topage({data:t,index:i})}}},[a("v-uni-view",{staticClass:"content-box"},[a("v-uni-view",{staticClass:"head"},[a("v-uni-view",{staticClass:"name"},[e._v(e._s(t.step_name))]),a("v-uni-view",{staticClass:"state"},[e._v("状态："+e._s(t.state))])],1),t._approval_user?a("v-uni-view",{staticClass:"state"},[e._v("责任人："),a("v-uni-text",[e._v(e._s(t._approval_user))])],1):e._e(),t._record_data?a("v-uni-view",{},[a("v-uni-text",{staticClass:"margin-right-xs"},[e._v("处理时间：")]),e._v(e._s(t._record_data.create_time))],1):e._e()],1)],1)})),1)],1)},n=[]},"7b7a":function(e,t,a){var i=a("24fb");t=i(!1),t.push([e.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 引入uview样式 */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */@-webkit-keyframes info-data-v-31c9b99a{0%{-webkit-transform:translate(100px);transform:translate(100px)}60%{-webkit-transform:translate(-10px);transform:translate(-10px)}100%{-webkit-transform:translate(0);transform:translate(0)}}@keyframes info-data-v-31c9b99a{0%{-webkit-transform:translate(100px);transform:translate(100px)}60%{-webkit-transform:translate(-10px);transform:translate(-10px)}100%{-webkit-transform:translate(0);transform:translate(0)}}uni-page-body[data-v-31c9b99a]{background-color:#f2f2f2}.bg[data-v-31c9b99a]{margin-top:%?20?%;background-color:#f2f2f2;display:-webkit-box;display:-webkit-flex;display:flex}.steps[data-v-31c9b99a]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;width:%?60?%;margin:0 %?30?%;margin-top:%?100?%}.steps .steps_item[data-v-31c9b99a]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.steps .steps_item uni-view[data-v-31c9b99a]{height:%?200?%;width:%?5?%}.steps .steps_item uni-text[data-v-31c9b99a]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;align-items:center;width:%?40?%;line-height:%?40?%;height:%?40?%;-webkit-border-radius:50%;border-radius:50%;font-size:10px}.info_list[data-v-31c9b99a]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;-webkit-box-flex:1;-webkit-flex:1;flex:1}.info_list .info_item[data-v-31c9b99a]{height:%?200?%;margin:%?20?% 0;margin-right:%?30?%;-webkit-border-radius:%?10?%;border-radius:%?10?%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;padding:0 %?30?%}.info_list .info_item[data-v-31c9b99a]:active{opacity:.6}.info_list .content-box .head[data-v-31c9b99a]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row}.info_list .content-box .name[data-v-31c9b99a]{-webkit-box-flex:1;-webkit-flex:1;flex:1;font-size:%?34?%;line-height:%?60?%;font-weight:700}.info_list .content-box .state[data-v-31c9b99a]{-webkit-box-flex:1;-webkit-flex:1;flex:1;font-size:%?30?%;line-height:%?60?%}body.?%PAGE?%[data-v-31c9b99a]{background-color:#f2f2f2}',""]),e.exports=t},8575:function(e,t,a){"use strict";a.r(t);var i=a("96f3"),r=a.n(i);for(var n in i)"default"!==n&&function(e){a.d(t,e,(function(){return i[e]}))}(n);t["default"]=r.a},"96f3":function(e,t,a){"use strict";(function(e){var i=a("4ea4");a("4de4"),a("4160"),a("d81d"),a("a9e3"),a("b64b"),a("3ca3"),a("159b"),a("ddb0"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("96cf");var r=i(a("1da1")),n=i(a("eaae")),o=i(a("8a02")),s=i(a("2e5a")),l={components:{bxform:n.default,uniPopup:o.default,BxSteps:s.default},data:function(){return{TabCur:1,scrollLeft:0,tabList:[{label:"基本信息"},{label:"流程步骤"},{label:"流程审批记录"}],isHandler:!1,activityData:{},proc_instance_no:"",scroll:0,type:"add",procRecord:[],recordFields:[],currentRecord:{},procBasicConfig:{},colsV2Data:{},srvInfo:{app:"",serviceName:"srvprocess_basic_cfg_select"},currentStepInfo:{},stepsCfgData:[],firstStepInfo:{},firstStepForm:[],formInfo:{serviceName:"",formType:""},showProcApproval:!1,approvalVal:{proc_result:"",remark:"",turn_user_no:"",step_no:""},fields:[],currentStepFields:[],authority:!1,approvalFormCfg:[{label:"意见",column:"proc_result",value:"",type:"radioFk",display:!0,isRequire:!0,isShowExp:[],options:[{value:"pass",label:"已处理"},{value:"turn",label:"转派"},{value:"return_to_start",label:"退回开始"},{value:"return_to_last",label:"退回"}]},{label:"转派用户",column:"turn_user_no",value:"",srvInfo:{serviceName:"srvsso_user_select",appNo:"sso",isTree:!1,column:"user_no",showCol:"real_name",srv_app:"sso"},option_list_v2:{refed_col:"user_no",srv_app:"sso",serviceName:"srvsso_user_select",conditions:[{colName:"dept_no",ruleType:"eq",value:"bx100sys"}],key_disp_col:"user_disp"},type:"treeSelector",display:!0,disabled:!1,isRequire:!0,isShowExp:[{colName:"proc_result",ruleType:"eq",value:"turn"}],options:[]},{label:"说明",column:"remark",value:"",type:"textarea",display:!0,isRequire:!1,isShowExp:[{colName:"proc_result",ruleType:"eq",value:"pass"}],options:[]},{label:"说明",column:"remark",value:"",type:"textarea",display:!0,isRequire:!0,isShowExp:[{colName:"proc_result",ruleType:"neq",value:"pass"}],options:[]}]}},methods:{tabSelect:function(e){this.TabCur=Number(e.currentTarget.dataset.id),this.scrollLeft=60*(e.currentTarget.dataset.id-1)},toRecordDetail:function(t){e.log(t),this.currentRecord=t,this.$refs.recordPopup.open()},hideApprovalForm:function(){this.$refs.approvalPopup.close()},showApprovalForm:function(e,t){var a=this;this.stepsCfgData=[],"已处理"===e.state?this.isHandler=!0:this.isHandler=!1,this.getApprovalForm(e).then((function(e){if(e){a.stepsCfgData=[];var i=a.deepClone(e);t&&"approval"==t&&(a.approvalFormCfg.forEach((function(e){e.value=""})),i.length>0&&i[0].fields&&i.forEach((function(e){e.fields.forEach((function(e){e.value=""}))}))),a.stepsCfgData=i,a.$refs.approvalPopup.open()}}))},clickSteps:function(t){var a=this;if(t.data.step_no!==this.currentStepInfo.step_no||this.procBasicConfig.proHanleData.authority){this.approvalFormCfg;var i=t.data,r=this.procRecord;r.forEach((function(t){i.step_no===t.step_no&&(i.remark=t.remark,i.proc_result=t.proc_result,e.log("step,record",i),Object.keys(i).forEach((function(e){a.approvalFormCfg.forEach((function(t,r){t.column===e&&(t["value"]=i[e],a.$set(a.approvalFormCfg,r,t))}))})))})),0!==t.index&&t.index<=this.scroll?"已处理"!==t.data.state?this.showApprovalForm(t.data,"approval"):this.showApprovalForm(t.data):0===t.index&&(this.TabCur=0),e.log("clickSteps",t)}else uni.showToast({title:"无权处理",icon:"none"})},getBasicCfg:function(e){var t=this;return(0,r.default)(regeneratorRuntime.mark((function a(){var i,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.srvInfo.serviceName,i={serviceName:"srvprocess_basic_cfg_select",colNames:["*"],condition:[{colName:"proc_instance_no",ruleType:"eq",value:e}]},a.next=4,t.onRequest("select","srvprocess_basic_cfg_select",i,"oa");case 4:r=a.sent,"SUCCESS"===r.data.state&&(t.procBasicConfig=r.data,t.activityData=r.data.mainData,t.getApprovalForm(r.data["proCharData"][r.data["proHanleData"]["activeStep"]]),t.getCurStepConfig(r.data["proCharData"][0],"firstStep"),t.currentStepInfo=r.data["proCharData"][r.data["proHanleData"]["activeStep"]],t.firstStepInfo=r.data["proCharData"][0],t.scroll=r.data.proHanleData.activeStep);case 6:case"end":return a.stop()}}),a)})))()},getApprovalForm:function(t){var a=this;return(0,r.default)(regeneratorRuntime.mark((function i(){var r,n,o;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(e.log("getApprovalForm",t),r=t.biz_cfg_data,[{type:"",serviceName:"",fields:[],formData:{}}],!(r&&r.length>0)){i.next=14;break}n=regeneratorRuntime.mark((function i(n){var o,s,l,c,p,u,f;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(o=r[n],"form"!==o.type){i.next=23;break}if(!o._type_form||"已处理"===t.state){i.next=12;break}return s=o["".concat(o._type_form,"_service")],l=o._type_form,i.next=7,a.getColV2(s,o._type_form);case 7:c=i.sent,r[n]["fields"]=c,r[n]["formType"]=l,i.next=23;break;case 12:if(!o.select_service||"已处理"!==t.state||!o._type_form){i.next=23;break}return p=o.select_service,i.next=16,a.getColV2(p,"detail");case 16:return u=i.sent,r[n]["formType"]="detail",i.next=20,a.getDetail(p,u);case 20:f=i.sent,e.log("getDetail(serviceName)",f),Object.keys(f).forEach((function(e){u.forEach((function(t,i){t.column===e&&(t["value"]=f[e],t["disabled"]=!0,a.$set(u,i,t),r[n]["fields"]=u)}))}));case 23:case"end":return i.stop()}}),i)})),o=0;case 6:if(!(o<r.length)){i.next=11;break}return i.delegateYield(n(o),"t0",8);case 8:o++,i.next=6;break;case 11:return i.abrupt("return",r);case 14:return i.abrupt("return",a.approvalFormCfg);case 15:case"end":return i.stop()}}),i)})))()},getProcRecord:function(){var t=this;return(0,r.default)(regeneratorRuntime.mark((function a(){var i,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return i={serviceName:"srvprocess_record_select",colNames:["*"],condition:[{colName:"proc_instance_no",value:t.proc_instance_no,ruleType:"eq"}],order:[{colName:"id",orderType:"desc"}]},a.next=3,t.onRequest("select","srvprocess_record_select",i,"oa");case 3:r=a.sent,"SUCCESS"===r.data.state&&(t.procRecord=r.data.data,t.getColV2(i.serviceName,"detail").then((function(a){e.log("recordFields",a),t.recordFields=a,t.procRecord.forEach((function(i,r){var n=t.deepClone(a);e.log("recordFields121",i),Object.keys(i).forEach((function(e){n.forEach((function(t,a){t.column===e&&(t["value"]=i[e])}))})),i["fields"]=n,t.$set(t.procRecord,r,i)}))})));case 5:case"end":return a.stop()}}),a)})))()},getDetail:function(t,a){var i=this;return(0,r.default)(regeneratorRuntime.mark((function r(){var n,o,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return uni.showLoading({}),n=a.map((function(e){return e.column})),o={serviceName:t,condition:[{colName:"proc_instance_no",ruleType:"eq",value:i.proc_instance_no}],colNames:n,hisVer:!0},r.next=5,i.onRequest("select",o.serviceName,o,"oa");case 5:if(s=r.sent,uni.hideLoading(),"SUCCESS"!==s.data.state){r.next=11;break}if(e.log("getDetail111",s.data.data),!(s.data.data.length>0)){r.next=11;break}return r.abrupt("return",s.data.data[0]);case 11:case"end":return r.stop()}}),r)})))()},getCurStepConfig:function(t,a){var i=this;if(t&&"未开始"!==t.state&&(e.log("getCurStepConfig",t),t.biz_cfg_data&&t.biz_cfg_data.length>0)){var r=t.biz_cfg_data;r.map((function(e){e._type_form?(i.formInfo.formType=e._type_form,i.type=e._type_form,i.formInfo.serviceName=e["".concat(e._type_form,"_service")],i.getColV2(i.formInfo.serviceName,e._type_form).then((function(e){"firstStep"===a?(i.fields=e,Object.keys(i.procBasicConfig.mainData).forEach((function(e){i.fields.forEach((function(t,a){t.column===e&&(t["value"]=i.procBasicConfig.mainData[e],i.$set(i.fields,a,t))}))}))):i.currentStepFields=e}))):e.select_service&&(i.formInfo.formType="detail",i.type="detail",i.formInfo.serviceName=e.select_service,i.getColV2(i.formInfo.serviceName,i.type).then((function(e){"firstStep"===a?(i.fields=e,Object.keys(i.procBasicConfig.mainData).forEach((function(e){i.fields.forEach((function(t,a){t.column===e&&(t["value"]=i.procBasicConfig.mainData[e],i.$set(i.fields,a,t))}))}))):i.currentStepFields=e})))}))}},approvalForm:function(){var t=this;return(0,r.default)(regeneratorRuntime.mark((function a(){var i,r,n,o,s,l,c,p,u,f,d,v,b,m,_,g;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(i=t,0!==t.procBasicConfig.proHanleData.activeStep){a.next=23;break}r=0;case 3:if(!(r<t.stepsCfgData.length)){a.next=21;break}if(n="bxFormStep"+r,o=t.stepsCfgData[r],!o.formType){a.next=18;break}if(s=o["".concat(o.formType,"_service")],l=i.$refs[n][0].getFieldModel(),l.file_no||(l.file_no=""),l.remark||(l.remark=""),!1!==l){a.next=13;break}return a.abrupt("return");case 13:return c=[{serviceName:"srvoa_issue_info_update",condition:[{colName:"proc_instance_no",ruleType:"eq",value:t.proc_instance_no}],proc_instance_no:t.proc_instance_no,data:[l]}],a.next=16,t.onRequest("apply",s,c,"oa");case 16:p=a.sent,"SUCCESS"===p.data.state?(e.log(p.data,"res.data"),uni.showToast({title:p.data.resultMessage,icon:"none"}),uni.showModal({title:"提示",content:p.data.resultMessage,showCancel:!1,success:function(e){e.confirm&&(i.hideApprovalForm(),i.getBasicCfg(i.proc_instance_no),i.getProcRecord(i.proc_instance_no))}})):uni.showToast({title:p.data.resultMessage,icon:"none"});case 18:r++,a.next=3;break;case 21:a.next=37;break;case 23:if(u=i.$refs.approvalForm.getFieldModel(),e.log("approval",u),f=[],t.procBasicConfig.mainData.id,t.stepsCfgData,"pass"===u.proc_result)for(d=0;d<t.stepsCfgData.length;d++)v="bxFormStep"+d,b=t.stepsCfgData[d],b.formType&&(b["".concat(b.formType,"_service")],m={serviceName:b["".concat(b.formType,"_service")],data:[i.$refs[v][0].getFieldModel()],condition:[{colName:"id",ruleType:"in",value:i.procBasicConfig.mainData.id}]},i.$refs[v][0].getFieldModel()&&f.push(m));return e.log(f,"child_data_list"),_=[{data:[{child_data_list:f,key:u.proc_result,proc_result:u.proc_result,remark:u.remark,turn_user_no:u.turn_user_no}],proc_instance_no:i.proc_instance_no,step_no:i.currentStepInfo.step_no}],t.getServiceUrl("oa","approval","process"),a.next=34,i.onRequest("process","approval",_,"oa");case 34:g=a.sent,"SUCCESS"===g.data.state?(e.log(g.data),uni.showToast({title:g.data.resultMessage,icon:"none"}),t.hideApprovalForm(),t.getBasicCfg(t.proc_instance_no),t.getProcRecord(t.proc_instance_no)):uni.showToast({title:g.data.resultMessage,icon:"none"}),e.log("reqData",_);case 37:case"end":return a.stop()}}),a)})))()},getColV2:function(t,a){var i=this;return(0,r.default)(regeneratorRuntime.mark((function r(){var n,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,i.getServiceV2(t,a,a,"oa");case 2:n=r.sent,i.colsV2Data=n,e.log("colsV2Data",n),o=[],r.t0=a,r.next="update"===r.t0?9:"add"===r.t0?11:"detail"===r.t0?13:15;break;case 9:return o=n._fieldInfo,r.abrupt("break",16);case 11:return o=n._fieldInfo,r.abrupt("break",16);case 13:return o=i.setFieldsDefaultVal(n._fieldInfo,i.activityData),r.abrupt("break",16);case 15:return r.abrupt("break",16);case 16:return 0===i.scroll&&"update"==a&&(o=i.setFieldsDefaultVal(n._fieldInfo,i.activityData)),o&&Array.isArray(o)&&(o=o.filter((function(e,t){return e.value||(e.value=""),e}))),e.log("colsV2Datafields",o),r.abrupt("return",o);case 20:case"end":return r.stop()}}),r)})))()}},onLoad:function(e){e.proc_instance_no&&(this.proc_instance_no=e.proc_instance_no,this.srvInfo.app=uni.getStorageSync("activeApp"),this.getBasicCfg(e.proc_instance_no),this.getProcRecord(e.proc_instance_no))}};t.default=l}).call(this,a("5a52")["default"])},a272:function(e,t,a){"use strict";a.r(t);var i=a("e309"),r=a.n(i);for(var n in i)"default"!==n&&function(e){a.d(t,e,(function(){return i[e]}))}(n);t["default"]=r.a},a64f:function(e,t,a){var i=a("7b7a");"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var r=a("4f06").default;r("0e1fc700",i,!0,{sourceMap:!1,shadowMode:!1})},a895:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){return i}));var i={uniPopup:a("8a02").default},r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",{staticClass:"proc-wrap"},[a("cu-custom",{attrs:{bgColor:"bg-blue",isBack:!0}},[a("template",{attrs:{slot:"backText"},slot:"backText"},[e._v("返回")]),a("template",{attrs:{slot:"content"},slot:"content"},[e._v("流程详情")])],2),a("v-uni-scroll-view",{staticClass:"bg-white nav ",attrs:{"scroll-x":!0}},[a("v-uni-view",{staticClass:"flex text-center"},e._l(e.tabList,(function(t,i){return a("v-uni-view",{key:i,staticClass:"cu-item flex-sub",class:i==e.TabCur?"text-orange cur":"",attrs:{"data-id":i},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.tabSelect.apply(void 0,arguments)}}},[e._v(e._s(t.label))])})),1)],1),0===e.TabCur?a("v-uni-view",{staticClass:"detail-view content-box"},[a("v-uni-view",{staticClass:"detail-form"},[a("bxform",{ref:"bxDetailForm",attrs:{pageType:e.type,BxformType:e.type,fields:e.fields}})],1)],1):e._e(),1===e.TabCur?a("v-uni-view",{staticClass:"steps-view content-box"},[a("BxSteps",{attrs:{infoList:e.procBasicConfig.proCharData,scroll:e.scroll},on:{clickSteps:function(t){arguments[0]=t=e.$handleEvent(t),e.clickSteps.apply(void 0,arguments)}}})],1):2===e.TabCur?a("v-uni-view",{staticClass:"step-list  content-box"},e._l(e.procRecord,(function(t,i){return a("v-uni-view",{key:i,staticClass:"step-list-item",on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.toRecordDetail(t)}}},[a("v-uni-view",{staticClass:"title"},[a("v-uni-text",{staticClass:"label"},[e._v("步骤名称：")]),a("v-uni-text",{staticClass:"value"},[e._v(e._s(t.step_no_name))])],1),a("v-uni-view",{staticClass:"status"},[a("v-uni-text",{staticClass:"label"},[e._v("处理结果：")]),a("v-uni-text",{staticClass:"value"},[e._v(e._s(t.proc_result))])],1),a("v-uni-view",{staticClass:"detail"},[a("v-uni-view",{staticClass:"detail-item"},[t.data_status?a("v-uni-view",{staticClass:"label"},[e._v("数据状态："+e._s(t.data_status))]):e._e(),a("v-uni-view",{staticClass:"value"})],1),a("v-uni-view",{staticClass:"detail-item"},[t.create_user?a("v-uni-view",{staticClass:"label"},[e._v("审核人："+e._s(t.create_user))]):e._e(),a("v-uni-view",{staticClass:"value"})],1),a("v-uni-view",{staticClass:"detail-item"},[t.create_user?a("v-uni-view",{staticClass:"label"},[e._v("创建人："+e._s(t.create_user))]):e._e(),a("v-uni-view",{staticClass:"value"})],1),a("v-uni-view",{staticClass:"detail-item"},[a("v-uni-view",{staticClass:"label"},[e._v("审核时间："+e._s(t.modify_time.slice(0,10)))]),a("v-uni-view",{staticClass:"value"})],1)],1)],1)})),1):e._e(),a("v-uni-view",{staticClass:"bottom-bar"},[a("v-uni-view",{staticStyle:{flex:"1"}},[a("v-uni-view",{},[a("v-uni-text",{staticClass:"text-gray"},[e._v(e._s("已处理"===e.currentStepInfo.state?"当前状态：":"当前步骤："))]),a("v-uni-text",{staticClass:"value text-blue"},[e._v(e._s("已处理"===e.currentStepInfo.state?e.currentStepInfo.state:e.currentStepInfo.step_name))])],1),a("v-uni-view",{},[a("v-uni-text",{staticClass:"text-gray"},[e._v("责任人：")]),a("v-uni-text",[e._v(e._s(e.currentStepInfo._approval_user?e.currentStepInfo._approval_user:e.currentStepInfo._approval_user_no))])],1)],1),e.procBasicConfig.proHanleData&&e.procBasicConfig.proHanleData.authority?a("v-uni-view",{},[e.procBasicConfig.proHanleData&&0!==e.procBasicConfig.proHanleData.activeStep?a("v-uni-text",{staticClass:"cu-btn bg-blue margin-right",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.showApprovalForm(e.currentStepInfo,"approval")}}},[e._v(e._s(e.currentStepInfo.step_name))]):e._e(),e.procBasicConfig.proHanleData&&0===e.procBasicConfig.proHanleData.activeStep?a("v-uni-text",{staticClass:"cu-btn bg-blue margin-right",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.showApprovalForm(e.currentStepInfo,"approval")}}},[e._v(e._s(e.currentStepInfo.step_name))]):e._e()],1):e._e()],1),a("uni-popup",{ref:"approvalPopup",attrs:{type:"bottom"}},[e.stepsCfgData.length>0?a("v-uni-view",{staticClass:"form-view"},[e._l(e.stepsCfgData,(function(e,t){return a("v-uni-view",{key:t,staticStyle:{width:"100%"}},[a("bxform",{ref:"bxFormStep"+t,refInFor:!0,attrs:{pageType:e.formType,BxformType:e.formType,fields:e.fields}})],1)})),e.isHandler?a("bxform",{ref:"approvalForm",attrs:{pageType:"detail",BxformType:"detail",fields:e.approvalFormCfg}}):e._e(),e.procBasicConfig.proHanleData&&0!==e.procBasicConfig.proHanleData.activeStep&&!e.isHandler?a("bxform",{ref:"approvalForm",attrs:{pageType:"add",BxformType:"add",fields:e.approvalFormCfg}}):e._e(),e.procBasicConfig.proHanleData&&0!==e.procBasicConfig.proHanleData.activeStep&&!e.isHandler?a("v-uni-view",{staticClass:"button-box"},[a("v-uni-text",{staticClass:"cu-btn bg-blue margin-right",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.approvalForm.apply(void 0,arguments)}}},[e._v("提交")]),a("v-uni-text",{staticClass:"cu-btn bg-green",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.$refs.approvalPopup.close()}}},[e._v("取消")])],1):e._e(),e.isHandler?a("v-uni-text",{staticClass:"cu-btn bg-blue",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.$refs.approvalPopup.close()}}},[e._v("确定")]):e._e()],2):e._e()],1),a("uni-popup",{ref:"recordPopup",attrs:{type:"bottom"}},[e.currentRecord.fields&&e.currentRecord.fields.length>0?a("v-uni-view",{staticClass:"form-view"},[a("bxform",{ref:"bxFormRecord ",attrs:{pageType:"detail",BxformType:"detail",fields:e.currentRecord.fields}}),a("v-uni-view",{staticClass:"cu-btn bg-blue radius",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.$refs.recordPopup.close()}}},[e._v("确定")])],1):e._e()],1)],1)},n=[]},bc87:function(e,t,a){"use strict";a.r(t);var i=a("a895"),r=a("8575");for(var n in r)"default"!==n&&function(e){a.d(t,e,(function(){return r[e]}))}(n);a("2f8e");var o,s=a("f0c5"),l=Object(s["a"])(r["default"],i["b"],i["c"],!1,null,"89584666",null,!1,i["a"],o);t["default"]=l.exports},c68e:function(e,t,a){"use strict";var i=a("a64f"),r=a.n(i);r.a},e309:function(e,t,a){"use strict";a("a9e3"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={name:"YSteps",props:{infoList:{type:Array,default:function(){}},scroll:{type:Number,default:-1},color:{type:String,default:"#ff3838"}},data:function(){return{}},onLoad:function(e){},methods:{topage:function(e){this.$emit("clickSteps",e)}}};t.default=i}}]);