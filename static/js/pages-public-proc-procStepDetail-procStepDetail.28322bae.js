(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-public-proc-procStepDetail-procStepDetail"],{"46f7":function(e,t,a){"use strict";a.r(t);var r=a("93b1"),n=a.n(r);for(var i in r)"default"!==i&&function(e){a.d(t,e,(function(){return r[e]}))}(i);t["default"]=n.a},"7c19":function(e,t,a){"use strict";var r;a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return r}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",{staticClass:"step-detail-wrap"},[a("v-uni-view",{staticClass:"form-view"},[a("bxform",{ref:"bxForm",attrs:{pageType:e.type,BxformType:e.type,fields:e.fields}})],1),"正在处理"===e.stepData.state&&e.fields.length>0?a("v-uni-view",{staticClass:"approval-view"},[a("bxform",{ref:"approvalForm",attrs:{pageType:"add",BxformType:"add",fields:e.approvalFormCfg}}),a("v-uni-view",{staticClass:"buttons"},[a("v-uni-button",{attrs:{type:"primary"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.approval.apply(void 0,arguments)}}},[e._v("提交审批")])],1)],1):e._e()],1)},i=[]},"93b1":function(e,t,a){"use strict";(function(e){var r=a("4ea4");a("99af"),a("4de4"),a("4160"),a("d81d"),a("b64b"),a("159b"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("96cf");var n=r(a("1da1")),i=r(a("eaae")),s={components:{bxform:i.default},data:function(){return{id:"",stepData:{},serviceName:"",proc_instance_no:"",type:"",fields:[],procBasicConfig:{},activityData:{},approvalFormCfg:[{label:"意见",column:"proc_result",value:"pass",type:"radioFk",display:!0,isRequire:!0,isShowExp:[],options:[{value:"pass",label:"已处理"},{value:"turn",label:"转派"},{value:"return_to_start",label:"退回开始"},{value:"return_to_last",label:"退回"}]},{label:"转派用户",column:"turn_user_no",value:"",type:"input",display:!0,isRequire:!0,isShowExp:[{colName:"proc_result",ruleType:"eq",value:"turn"}],options:[]},{label:"说明",column:"remark",value:"",type:"textarea",display:!0,isRequire:!0,isShowExp:[],options:[]}],formFields:[]}},methods:{getBasicCfg:function(e,t){var a=this;return(0,n.default)(regeneratorRuntime.mark((function r(){var n,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n={serviceName:"srvprocess_basic_cfg_select",colNames:["*"],condition:[{colName:"proc_instance_no",ruleType:"eq",value:e}]},r.next=3,a.onRequest("select","srvprocess_basic_cfg_select",n,"oa");case 3:i=r.sent,"SUCCESS"===i.data.state&&(a.procBasicConfig=i.data,i.data["proCharData"]&&i.data["proCharData"].length>0&&i.data["proCharData"].map((function(e){e.step_no===t&&(a.stepData=e,a.getCurStepConfig(e))})));case 5:case"end":return r.stop()}}),r)})))()},getCurStepConfig:function(t,a){var r=this,n=this;if(t&&"未开始"!==t.state&&(this.authority=t.authority,this.authority||this.approvalFormCfg.map((function(e){e.disabled=!0})),e.log("getCurStepConfig",t),t.biz_cfg_data&&t.biz_cfg_data.length>0)){var i=t.biz_cfg_data[0];n.getColV2(i["select_service"],n.type).then((function(t){e.log("fields",t,r.type),r.formFields=t,r.fields=t.concat(r.approvalFormCfg);var a={};r.fields.forEach((function(e){e.display&&!e.disabled&&(a[e.column]="",r.$set(r.activityData,e.column,""))})),n.getDetail(i["select_service"],t).then((function(){}))}))}},getDetail:function(t,a){var r=this;return(0,n.default)(regeneratorRuntime.mark((function n(){var i,s,o,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return i=r,s=a.map((function(e){return e.column})),o={serviceName:t,condition:[{colName:"proc_instance_no",ruleType:"eq",value:r.proc_instance_no}],colNames:s},n.next=5,r.onRequest("select",o.serviceName,o,"oa");case 5:c=n.sent,"SUCCESS"===c.data.state&&(e.log("getDetail111",c.data.data),c.data.data.length>0&&(i.id=c.data.data[0].id,Object.keys(c.data.data[0]).forEach((function(e){i.fields.forEach((function(t,a){t.column===e&&(t["value"]=c.data.data[0][e],i.$set(i.fields,a,t))}))}))));case 7:case"end":return n.stop()}}),n)})))()},getColV2:function(t,a){var r=this;return(0,n.default)(regeneratorRuntime.mark((function n(){var i,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,r.getServiceV2(t,a,a,"oa");case 2:i=n.sent,r.colsV2Data=i,e.log("colsV2Data",i),s=[],n.t0=a,n.next="update"===n.t0?9:"detail"===n.t0?11:13;break;case 9:return s=r.setFieldsDefaultVal(i._fieldInfo,r.activityData),n.abrupt("break",14);case 11:return s=r.setFieldsDefaultVal(i._fieldInfo,r.activityData),n.abrupt("break",14);case 13:return n.abrupt("break",14);case 14:return s&&Array.isArray(s)&&(s=s.filter((function(e,t){return e.value||(e.value=""),r.authority||(e.disabled=!0),e}))),n.abrupt("return",s);case 16:case"end":return n.stop()}}),n)})))()},approval:function(){var t=this,a=t.$refs.bxForm.getFieldModel();e.log("itemData",a);var r={proc_instance_no:this.proc_instance_no,step_no:this.procBasicConfig.proHanleData.step_no,data:[]},n=a;Object.keys(n);if(r.data.push(n),a.proc_result&&"pass"===a.proc_result){var i=[],s={serviceName:this.stepData.biz_cfg_data[0].update_service,condition:[{colName:"id",ruleType:"in",value:this.id}]};i.push(s)}}},onLoad:function(e){e.step_no&&e.proc_instance_no&&e.type&&(this.type=e.type,this.proc_instance_no=e.proc_instance_no,this.getBasicCfg(e.proc_instance_no,e.step_no))}};t.default=s}).call(this,a("5a52")["default"])},a493:function(e,t,a){var r=a("24fb");t=r(!1),t.push([e.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 引入uview样式 */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */.step-detail-wrap[data-v-04aadd3e]{width:100%;min-height:100vh;background-color:#fff}.step-detail-wrap .buttons[data-v-04aadd3e]{height:%?200?%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center}',""]),e.exports=t},a7e0:function(e,t,a){"use strict";var r=a("f49d"),n=a.n(r);n.a},f49d:function(e,t,a){var r=a("a493");"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var n=a("4f06").default;n("6aaa22d7",r,!0,{sourceMap:!1,shadowMode:!1})},f538:function(e,t,a){"use strict";a.r(t);var r=a("7c19"),n=a("46f7");for(var i in n)"default"!==i&&function(e){a.d(t,e,(function(){return n[e]}))}(i);a("a7e0");var s,o=a("f0c5"),c=Object(o["a"])(n["default"],r["b"],r["c"],!1,null,"04aadd3e",null,!1,r["a"],s);t["default"]=c.exports}}]);